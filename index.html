

<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="DC Gun Crime : ">

    <link rel="stylesheet" type="text/css" media="screen" href="static/css/stylesheet.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="static/css/jquery-ui-1.10.0.custom.min.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="static/css/leaflet.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="static/css/iThing.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="static/css/prism.css"/>
    <script type="text/javascript" src="static/js/lib/prism.js"></script>
    <script type="text/javascript" src="static/js/lib/jquery.min.js"></script>
    <script type="text/javascript" src="static/js/lib/leaflet.js"></script>
    <script type="text/javascript" src="static/js/lib/jquery-ui-1.10.0.custom.min.js"></script>
    <script type="text/javascript" src="static/js/lib/jquery-ui-timepicker-addon.js"></script>
    <script type="text/javascript" src="static/js/lib/jQDateRangeSlider-min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/js/lib/handlebars-v2.0.0.js"></script>
    <script type="text/javascript" src="static/js/lib/main.js"></script>
    <script id="popup-template" type="text/x-handlebars-template">
    <div class="popup">
      <p>{{OFFENSE}}</p>
      <p>{{BLOCKSITEADDRESS}}</p>
      <p>{{REPORTDATETIME}}</p>
    </div>
    </script>

    <title>DC Gun Crime</title>
  </head>

  <body>
    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/will-horning/dc_gun_crime">View on GitHub</a>

          <h1 id="project_title">DC Gun Crime</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/will-horning/dc_gun_crime/zipball/gh-pages">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/will-horning/dc_gun_crime/tarball/gh-pages">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
          <a name="designer-templates" class="anchor" href="#designer-templates">
            <span class="octicon octicon-link"></span></a>
          Ipsum Lorem
        </h3>
        <p> Map: </p>
        <div id="slider"></div><br>
        <div id="map" style="position:relative;height:700px"></div>


        <h3>
          <a name="designer-templates" class="anchor" href="#designer-templates">
            <span class="octicon octicon-link"></span></a>
            Converting State Plane Coordinates
        </h3>
        <p>
          The crime data uses the Maryland state plane coordinate system, whereas the Shotspotter data uses decimal latitude and longitude. Since its easier to use Lat,Lon coordinates with Leaflet, I converted the SPCS coordinates in the crime data to Lat,Lon using the script below. This code depends on the GDAL library, and I could not find a way to get it working inside virtualenv, so if you want to run this script you'll have to run install it globally. 

          The bx-python package includes a fast interval tree to find overlapping time ranges. In this case, I just to need to find any crime whose datetime ranges include the datetime of a shotspotter event.
          <pre>
          <code class="language-python">
from bx.intervals.intersection import Intersecter, Interval

tree = Intersecter()
crimes = [c for c in crimes if c not in bad_crime_dates]
for crime in crimes:
  start, end = crime['START_DATE_UT'], crime['END_DATE_UT']
  try:
    tree.add_interval(Interval(int(start), int(end), crime))
  except OverflowError:
    print start, end
          </code></pre>
        </p>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">dc_gun_crime maintained by <a href="https://github.com/will-horning">will-horning</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>
  </body>
</html>